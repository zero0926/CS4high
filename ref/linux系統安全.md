#
```
linux系統安全：縱深防禦、安全掃描與入侵偵測
胥峰  機械工業出版社 2019-07-01  ISBN 號: 9787111632184

```
```
1章 Linux系統安全概述1
1.1 什麼是安全2
1.1.1 什麼是資訊安全2
1.1.2 資訊安全的木桶原理4
1.1.3 Linux系統安全與資訊安全的關係5
1.2 威脅分析模型5
1.2.1 STRIDE模型5
1.2.2 常見的安全威脅來源6
1.3 安全的原則8
1.3.1 縱深防禦8
1.3.2 運用PDCA模型9
1.3.3 小許可權法則11
1.3.4 白名單機制12
1.3.5 安全地失敗12
1.3.6 避免通過隱藏來實現安全13
1.3.7 入侵偵測14
1.3.8 不要信任基礎設施14
1.3.9 不要信任服務15
1.3.10 交付時保持默認是安全的15
1.4 組織和管理的因素16
1.4.1 加強安全意識培訓16
1.4.2 特別注意弱密碼問題17
1.4.3 明令禁止使用破解版軟體18
1.4.4 組建合理的安全性群組織結構18


2章 Linux網路防火牆21
2.1 網路防火牆概述21
2.2 利用iptables構建網路防火牆23
2.2.1 理解iptables表和鏈23
2.2.2 實際生產中的iptables腳本編寫25
2.2.3 使用iptables進行網路位址轉譯27
2.2.4 禁用iptables的連接追蹤29
2.3 利用Cisco防火牆設置存取控制34
2.4 利用TCP Wrappers構建應用存取控制清單35
2.5 利用DenyHosts防止暴力破解36
2.6 在公有雲上實施網路安全防護38
2.6.1 減少公網暴露的雲伺服器數量39
2.6.2 使用網路安全性群組防護40
2.7 使用堡壘機增加系統訪問的安全性41
2.7.1 開源堡壘機簡介43
2.7.2 商業堡壘機簡介44
2.8 分散式拒絕服務攻擊的防護措施46
2.8.1 直接式分散式拒絕服務攻擊46
2.8.2 反射式分散式拒絕服務攻擊47
2.8.3 防禦的思路48
2.9 局域網中ARP欺騙的防禦48


3章 虛擬私人網路絡52
3.1 常見虛擬私人網路絡構建技術53
3.1.1 PPTP虛擬私人網路絡的原理53
3.1.2 IPSec虛擬私人網路絡的原理53
3.1.3 SSL/TLS虛擬私人網路絡的原理54
3.2 深入理解OpenVPN的特性55
3.3 使用OpenVPN創建點到點的虛擬私人網路絡55
3.4 使用OpenVPN創建遠端存取的虛擬私人網路絡61
3.5 使用OpenVPN創建網站到網站虛擬私人網路絡69
3.6 回收OpenVPN用戶端的證書70
3.7 使用OpenVPN提供的各種script功能71
3.8 OpenVPN的排錯步驟73


4章 網路流量分析工具79
4.1 理解tcpdump工作原理80
4.1.1 tcpdump的實現機制80
4.1.2 tcpdump與iptables的關係82
4.1.3 tcpdump的簡要安裝步驟82
4.1.4 學習tcpdump的5個參數和篩檢程式83
4.1.5 學習tcpdump的篩檢程式83
4.2 使用RawCap抓取回環埠的資料84
4.3 熟悉Wireshark的佳配置項85
4.3.1 Wireshark安裝過程的注意事項85
4.3.2 Wireshark的關鍵配置項86
4.3.3 使用追蹤資料流程功能89
4.4 使用libpcap進行自動化分析90
4.5 案例1：定位非正常發包問題91
4.6 案例2：分析運營商劫持問題94
4.6.1 中小運營商的網路現狀94
4.6.2 基於下載檔案的緩存劫持95
4.6.3 基於頁面的iframe廣告嵌入劫持99
4.6.4 基於偽造DNS回應的劫持100
4.6.5 網卡混雜模式與raw socket技術100
4.7 本章小結103
5章 Linux用戶管理105
5.1 Linux用戶管理的重要性105
5.2 Linux用戶管理的基本操作107
5.2.1 增加用戶108
5.2.2 為使用者設置密碼108
5.2.3 刪除用戶109
5.2.4 修改使用者屬性109
5.3 存儲Linux使用者資訊的關鍵檔詳解110
5.3.1 passwd文件說明110
5.3.2 shadow文件說明111
5.4 Linux使用者密碼管理112
5.4.1 密碼複雜度設置112
5.4.2 生成複雜密碼的方法113
5.4.3 弱密碼檢查方法116
5.5 用戶特權管理118
5.5.1 限定可以使用su的用戶118
5.5.2 安全地配置sudo118
5.6 關鍵環境變數和日誌管理119
5.6.1 關鍵環境變數設置唯讀119
5.6.2 記錄日誌執行時間戳記119
5.7 本章小結120
6章 Linux套裝軟體管理122
6.1 RPM概述122
6.2 使用RPM安裝和移除軟體123
6.2.1 使用RPM安裝和升級軟體123
6.2.2 使用RPM移除軟體124
6.3 獲取套裝軟體的資訊125
6.3.1 列出系統中已安裝的所有RPM包125
6.3.2 套裝軟體的詳細資訊查詢125
6.3.3 查詢哪個軟體包含有指定檔126
6.3.4 列出套裝軟體中的所有檔126
6.3.5 列出套裝軟體中的設定檔127
6.3.6 解壓套裝軟體內容127
6.3.7 檢查檔完整性127
6.4 Yum及Yum源的安全管理129
6.4.1 Yum簡介129
6.4.2 Yum源的安全管理130
6.5 自啟動服務管理130


7章 Linux檔案系統管理133
7.1 Linux檔案系統概述133
7.1.1 Inode134
7.1.2 文件的許可權135
7.2 SUID和SGID可執行檔136
7.2.1 SUID和SGID可執行檔概述136
7.2.2 使用sXid監控SUID和SGID檔變化137
7.3 Linux檔案系統管理的常用工具137
7.3.1 使用chattr對關鍵檔加鎖137
7.3.2 使用extundelete恢復已刪除檔138
7.3.3 使用srm和dd安全擦除敏感檔的方法141
7.4 案例：使用Python編寫敏感檔掃描程式141

8章 Linux應用安全145
8.1 簡化的網站架構和資料流程向145
8.2 主要網站漏洞解析146
8.2.1 注入漏洞147
8.2.2 跨站腳本漏洞148
8.2.3 資訊洩露149
8.2.4 檔解析漏洞150
8.3 Apache安全152
8.3.1 使用HTTPS加密網站153
8.3.2 使用ModSecurity加固Web154
8.3.3 關注Apache漏洞情報158
8.4 Nginx安全158
8.4.1 使用HTTPS加密網站158
8.4.2 使用NAXSI加固Web159
8.4.3 關注Nginx漏洞情報160
8.5 PHP安全160
8.5.1 PHP配置的安全選項160
8.5.2 PHP開發框架的安全162
8.6 Tomcat安全163
8.7 Memcached安全165
8.8 Redis安全165
8.9 MySQL安全166
8.10 使用公有雲上的WAF服務167


9章 Linux資料備份與恢復170
9.1 資料備份和恢復中的關鍵指標171
9.2 Linux下的定時任務172
9.2.1 本地定時任務172
9.2.2 分散式定時任務系統174
9.3 備份存儲位置的選擇175
9.3.1 本地備份存儲175
9.3.2 遠端備份存儲176
9.3.3 離線備份177
9.4 資料備份178
9.4.1 檔案備份178
9.4.2 資料庫備份179
9.5 備份加密181
9.6 資料庫恢復182
9.7 生產環境中的大規模備份系統案例182

10章 Linux安全掃描工具186
10.1 需要重點關注的敏感埠列表186
10.2 掃描工具nmap188
10.2.1 使用源碼安裝nmap188
10.2.2 使用nmap進行主機發現189
10.2.3 使用nmap進行TCP埠掃描190
10.2.4 使用nmap進行UDP埠掃描192
10.2.5 使用nmap識別應用192
10.3 掃描工具masscan193
10.3.1 安裝masscan193
10.3.2 masscan用法示例193
10.3.3 聯合使用masscan和nmap194
10.4 開源Web漏洞掃描工具195
10.4.1 Nikto2195
10.4.2 OpenVAS196
10.4.3 SQLMap198
10.5 商業Web漏洞掃描工具199
10.5.1 Nessus199
10.5.2 Acunetix Web Vulnerability Scanner201


11章 入侵偵測系統204
11.1 IDS與IPS204
11.2 開源HIDS OSSEC部署實踐205
11.3 商業主機入侵偵測系統214
11.3.1 青藤雲215
11.3.2 安全狗215
11.3.3 安騎士215
11.4 Linux Prelink對檔完整性檢查的影響217
11.5 利用Kippo搭建SSH蜜罐218
11.5.1 Kippo簡介218
11.5.2 Kippo安裝219
11.5.3 Kippo捕獲入侵案例分析220


12章 Linux Rootkit與病毒木馬檢查223
12.1 Rootkit分類和原理223
12.2 可載入內核模組225
12.3 利用Chkrootkit檢查Rootkit226
12.3.1 Chkrootkit安裝227
12.3.2 執行Chkrootkit227
12.4 利用Rkhunter檢查Rootkit228
12.4.1 Rkhunter安裝228
12.4.2 執行Rkhunter228
12.5 利用ClamAV掃描病毒木馬229
12.6 可疑檔的線上病毒木馬檢查230
12.6.1 VirusTotal231
12.6.2 VirSCAN231
12.6.3 Jotti232
12.7 Webshell檢測232
12.7.1 D盾233
12.7.2 LMD檢查Webshell234


13章 日誌與審計237
13.1 搭建遠端日誌收集系統237
13.1.1 Syslog-ng server搭建238
13.1.2 Rsyslog/Syslog client配置239
13.2 利用Audit審計系統行為239
13.2.1 審計目標239
13.2.2 組件240
13.2.3 安裝241
13.2.4 配置241
13.2.5 轉換系統調用242
13.2.6 審計Linux的進程243
13.2.7 按照用戶來審計檔訪問244
13.3 利用unhide審計隱藏進程244
13.4 利用lsof審計進程打開檔245
13.5 利用netstat審計網路連接246


14章 威脅情報248
14.1 威脅情報的概況248
14.2 主流威脅情報介紹249
14.2.1 微步線上威脅情報社區249
14.2.2 360威脅情報中心252
14.2.3 IBM威脅情報中心253
14.3 利用威脅情報提高攻擊檢測與防禦能力254


附錄A 網站安全開發的原則257
附錄B Linux系統被入侵後的排查過程273

```
